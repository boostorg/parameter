# Copyright David Abrahams, Daniel Wallin 2006.
# Distributed under the Boost Software License, Version 1.0.
# (See accompanying file LICENSE_1_0.txt or copy at
# http://www.boost.org/LICENSE_1_0.txt)

# Boost Parameter Library test Jamfile

import python ;

project boost/parameter
    :
    default-build <warnings>off <preserve-target-tests>off
    ;

build-project literate ;

test-suite "parameter"
    :
    [ compile unwrap_cv_reference.cpp ]
    [ compile unwrap_cv_reference.cpp
        :
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : unwrap_cv_ref_no_perfect_fwd
    ]
    [ compile function_type_tpl_param.cpp ]
    [ compile function_type_tpl_param.cpp
        :
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : func_type_tpl_prm_no_perfect_fwd
    ]
    [ compile ntp.cpp
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
    ]
    [ compile ntp.cpp
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : ntp_no_perfect_fwd
    ]
    [ run maybe.cpp ]
    [ run maybe.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : maybe_no_perfect_fwd
    ]
    [ run singular.cpp ]
    [ run singular.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : singular_no_perfect_fwd
    ]
    [ run tutorial.cpp ]
    [ run tutorial.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : tutorial_no_perfect_fwd
    ]
    [ run compose.cpp ]
    [ run compose.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : compose_no_perfect_fwd
    ]
    [ run sfinae.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=2
    ]
    [ run sfinae.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=2
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : sfinae_no_perfect_fwd
    ]
    [ run efficiency.cpp : : : : : <variant>release ]
    [ run efficiency.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : efficiency_no_perfect_fwd
        :
        <variant>release
    ]
    [ run evaluate_category.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=5
    ]
    [ run evaluate_category.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=5
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : eval_cat_no_perfect_fwd
    ]
    [ run evaluate_category_10.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=10
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=11
    ]
    [ run evaluate_category_10.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=10
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=11
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : eval_cat_10_no_perfect_fwd
    ]
    [ run evaluate_category_16.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=16
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=1
    ]
    [ run evaluate_category_16.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=16
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=1
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : eval_cat_16_no_perfect_fwd
    ]
    [ run normalized_argument_types.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=2
    ]
    [ run normalized_argument_types.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=2
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : norm_arg_types_no_perfect_fwd
    ]
    [ run basics.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
    ]
    [ run basics.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : basics_no_perfect_fwd
    ]
    [ run mpl.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
    ]
    [ run mpl.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : mpl_no_perfect_fwd
    ]
    [ run earwicker.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
    ]
    [ run earwicker.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : earwicker_no_perfect_fwd
    ]
    [ run macros.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
    ]
    [ run macros.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : macros_no_perfect_fwd
    ]
    [ run macros_eval_category.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=10
    ]
    [ run macros_eval_category.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=10
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : macros_eval_cat_no_perfect_fwd
    ]
    [ run preprocessor.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
    ]
    [ run preprocessor.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : preproc_no_perfect_fwd
    ]
    [ run preprocessor_deduced.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
    ]
    [ run preprocessor_deduced.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : preproc_ded_no_perfect_fwd
    ]
    [ run preprocessor_eval_category.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=5
    ]
    [ run preprocessor_eval_category.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=5
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : preproc_eval_cat_no_perfect_fwd
    ]
    [ run preprocessor_eval_cat_8.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=8
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=9
    ]
    [ run preprocessor_eval_cat_8.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=8
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=9
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : preproc_eval_cat_8_no_perfect_fwd
    ]
    [ run deduced.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
    ]
    [ run deduced.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : deduced_no_perfect_fwd
    ]
    [ run optional_deduced_sfinae.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
    ]
    [ run optional_deduced_sfinae.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : opt_ded_sfinae_no_perfect_fwd
    ]
    [ run deduced_dependent_predicate.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
    ]
    [ run deduced_dependent_predicate.cpp
        :
        :
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_DISABLE_PERFECT_FORWARDING
        : ded_dep_pred_no_perfect_fwd
    ]
    [ compile-fail duplicates.cpp
        :
        : duplicates_fail
    ]
    [ compile-fail deduced_unmatched_arg.cpp
        :
        : deduced_unmatched_arg_fail
    ]
    [ compile-fail basics.cpp
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>LIBS_PARAMETER_TEST_COMPILE_FAILURE
        : basics_fail
    ]
    [ compile-fail compose.cpp
        :
        <define>LIBS_PARAMETER_TEST_COMPILE_FAILURE
        : compose_fail
    ]
    [ compile-fail evaluate_category.cpp
        :
        <define>BOOST_PARAMETER_MAX_ARITY=4
        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=5
        <define>LIBS_PARAMETER_TEST_COMPILE_FAILURE
        : evaluate_category_fail
    ]
    [ compile-fail deduced.cpp
        :
        <define>LIBS_PARAMETER_TEST_COMPILE_FAILURE
        : deduced_fail
    ]
#    [ compile-fail preprocessor_eval_category.cpp
#        :
#        <define>BOOST_PARAMETER_MAX_ARITY=8
#        <define>BOOST_PARAMETER_ALL_CONST_THRESHOLD_ARITY=9
#        <define>LIBS_PARAMETER_TEST_COMPILE_FAILURE
#        : preproc_eval_cat_fail
#    ]
    [ bpl-test python_test ]
    ;

